#!/bin/sh

# Get the current branch name
current_branch=$(git symbolic-ref --short HEAD)

# If not on the master branch, exit directly
if [ "$current_branch" != "master" ]; then
    echo "Not on the master branch, skipping pre-push hook"
    exit 0
fi

# Output debug information
echo "pre-push hook starts executing (master branch only)"

# Switch to the repository root directory
cd "$(git rev-parse --show-toplevel)"

# Upload files to Alibaba Cloud OSS
echo "prepare_upload.bat start ..."
cmd.exe /c prepare_upload.bat

echo "pre-push hook execution completed"